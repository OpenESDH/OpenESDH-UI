<app-header></app-header>

<md-content layout-padding>
  <h2>{{ case["oe:id"].value }} {{ case["cm:title"].value }}</h2>
</md-content>

<md-tabs md-dynamic-height>
  
  <md-tab>
    <md-tab-label>
      <span>Case home</span>
    </md-tab-label>
    <md-tab-body>
      
      <div layout="row" layout-wrap>
        
        <div flex="50">
          <md-card>
            <md-card-content>
              <h3>Information</h3>
              <dl>
                <dt>Case ID</dt><dd>{{ case["oe:id"].value }}</dd>
                <dt>Case title</dt><dd>{{ case["cm:title"].value }}</dd>
                <dt>Status</dt><dd>{{ case["oe:status"].value }}</dd>
                <dt>Created by</dt><dd>{{ case["cm:creator"].fullname }}</dd>
                <dt>Created</dt><dd>{{ case["cm:created"].value | date: 'yyyy-MM-dd'}}</dd>
                <dt>Case owners</dt><dd>{{ case["base:owners"].fullname }}</dd>
                <dt>Last modified</dt><dd>{{ case["cm:modified"].value  | date: 'yyyy-MM-dd'}}</dd>
                <dt>Description</dt><dd>{{ case["cm:description"].value }}</dd>
              </dl>
            </md-card-content>
            <div class="md-actions" layout="row">
              <md-button class="md-primary" ng-click="createCase($event)">Edit information</md-button>
              <md-button class="md-primary" ng-disabled="true">Print case</md-button>
              <md-button class="md-primary" ng-disabled="true">Start workflow</md-button>
              <md-button class="md-primary" ng-disabled="true">Create site</md-button>
            </div>
          </md-card>
        </div>
        
        <div flex="50">
          <md-card ng-controller="NoteController as caseNotes">
            <md-card-content>
              <h3>Notes</h3>
              <md-list>
                <md-list-item ng-repeat="note in caseNotes.notes">
                  <div class="md-list-item-text">
                    <h4>{{ note.headline }}</h4>
                    <p>{{ note.content }}</p>
                    <p style="font-size: 0.8em; color: #999;">
                      Created {{ note.created | date: 'yyyy-MM-dd' }} by {{ note.authorInfo.firstName + ' ' + note.authorInfo.lastName }}<br>
                      Related: <span style="margin-right: 0.5em;" ng-repeat="relation in note.concernedPartiesInfo">{{ relation.name }}</span>
                    </p>
                  </div>
                </md-list-item>                
              </md-list>
                Loaded: {{caseNotes.contentRange.startIndex}}-{{caseNotes.contentRange.endIndex}} Total items: {{caseNotes.contentRange.totalItems}}
                Pages: <span style="margin-right: 10px;" ng-repeat="page in caseNotes.pages"><button ng-click="caseNotes.loadNotes(page)">{{page}}</button></span>
            </md-card-content>
            <div class="md-actions" layout="row">
              <md-button class="md-primary" ng-click="caseNotes.newNote()">New note</md-button>
              <md-button class="md-primary" ng-disabled="true">Print all notes</md-button>
            </div>
          </md-card>
        </div>
        
        <div flex="100">
          <md-card>
            <md-card-content ng-controller="DocumentController as docCtrl">
              <h3>Documents</h3>
              <table>
                <thead>
                  <tr>
                    <th>Title</th>
                    <th>Doc.No.</th>
                    <th>Type</th>
                    <th>Category</th>
                    <th>State</th>
                    <th>Owner</th>
                    <th>Created</th>
                    <th>Modified</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr ng-repeat="doc in docCtrl.documents" class="{{ doc.isUpdated ? 'updated' : 'not-updated' }}">
                    <td>{{ doc["cm:name"] }}</td>
                    <td>{{ doc.docNo }}</td>
                    <td>{{doc["doc:type"] | docType}}</td>
                    <td>{{doc["doc:category"] | docCategory}}</td>
                    <td>{{doc["doc:state"] | docStatus}}</td>
                    <td>
                        <span ng-repeat="owner in doc['doc:owner']">{{owner.fullname}}</span>
                    </td>
                    <td>{{doc["cm:created"] | date: 'yyyy-MM-dd'}}</td>
                    <td>{{doc["cm:modified"] | date: 'yyyy-MM-dd'}}</td>
                    <td><md-button class="md-primary" ng-disabled="true">View details</md-button> <md-button class="md-primary" ng-disabled="true">Preview</md-button></td>
                  </tr>
                </tbody>
              </table>
              Pages: <button ng-repeat="page in docCtrl.pages" ng-click="docCtrl.loadDocuments(page)">{{page}}</button>
            </md-card-content>
            <div class="md-actions" layout="row">
              <md-button class="md-primary" ng-disabled="true">Create new document</md-button>
              <md-button class="md-primary" ng-disabled="true">Upload new documents</md-button>
              <md-button class="md-primary" ng-disabled="true">Email documents</md-button>
            </div>
          </md-card>
        </div>
        
      </div>
      
    </md-tab-body>
  </md-tab>
  
  <md-tab>
    <md-tab-label>
      <span>Members</span>
    </md-tab-label>
    <md-tab-body layout="column">
      <md-card>
        <md-card-content>
          <h3>Members</h3>
        </md-card-content>
        <div class="md-actions">
        </div>
      </md-card>
    </md-tab-body>
  </md-tab>
  
  <md-tab>
    <md-tab-label>
      <span>Parties</span>
    </md-tab-label>
    <md-tab-body layout="column">
      <md-card>
        <md-card-content>
          <h3>Parties</h3>
        </md-card-content>
        <div class="md-actions">
        </div>
      </md-card>
    </md-tab-body>
  </md-tab>
  
  <md-tab>
    <md-tab-label>
      <span>History</span>
    </md-tab-label>
    <md-tab-body layout="column">
      <md-card>
        <md-card-content>
          <h3>History</h3>
        </md-card-content>
        <div class="md-actions">
        </div>
      </md-card>
    </md-tab-body>
  </md-tab>
  
</md-tabs>
