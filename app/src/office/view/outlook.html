<md-card>
    <md-card-content>
        <h2>{{ 'OFFICE.SAVE_EMAIL_IN_OPENESDH' | translate }}</h2>
        <form name="form">
            <md-autocomplete required md-input-name="autocompleteField" md-input-minlength="2" md-selected-item="vm.selectedCase" md-search-text="searchText" md-items="item in vm.querySearch(searchText)" md-item-text="item['oe:id']" md-floating-label="Case">
                <md-item-template>
                    <span md-highlight-text="searchText">{{item['oe:id'] }} {{item['cm:title']}}</span>
                    <!--<span md-highlight-text="searchText" class="muted">(ID: {{item.id}})</span>-->
                </md-item-template>
            </md-autocomplete>
            <md-input-container>
                <label>{{ 'COMMON.TITLE' | translate }}</label>
                <input type="text" ng-model="vm.subject" required>
            </md-input-container>
            <md-list ng-show="vm.attachments.length > 0">
                <md-subheader class="md-no-sticky">{{ 'DOCUMENT.ATTACHMENTS' | translate }}:</md-subheader>
                <md-list-item ng-repeat="attachment in vm.attachments">
                    <md-checkbox ng-model="attachment.selected"></md-checkbox>
                    <p>{{attachment.Name}}</p>
                </md-list-item>
            </md-list>

            <!-- Create case content embedded here -->
            <div layout="row" layout-align="center center">
                <md-whiteframe class="md-whiteframe-3dp" flex="50">
                    <ng-include src="vm.formTemplateUrl"></ng-include>
                </md-whiteframe>
            </div>
            <!-- End create case content -->

            <div class="md-actions" layout="row">
                <md-button type="submit" class="md-primary" ng-click="vm.save(form)" ng-disabled="form.$invalid">{{ 'COMMON.SAVE_EMAIL' | translate }}</md-button>
                <md-menu ng-controller="CreateCaseMenuController as ctrl">
                    <md-button class="md-primary" ng-click="$mdOpenMenu($event)" aria-label="{{ 'CASE.CREATE_NEW_CASE' | translate }}">
                        <i class="material-icons">add</i> {{ 'CASE.CREATE_NEW_CASE' | translate }}
                    </md-button>
                    <md-menu-content>
                        <md-menu-item ng-repeat="caseType in ctrl.registeredCaseTypes">
                            <md-button ng-click="vm.setPartial(caseType)">{{ caseType | caseType }}</md-button>
                        </md-menu-item>
                        <md-menu-item>
                            <md-button ng-disabled="true">{{ 'CASE.CASETYPE_OTHER' | translate }}</md-button>
                        </md-menu-item>
                    </md-menu-content>
                </md-menu>
                <md-button type="button" ng-click="vm.cancel(form)">{{ 'COMMON.CANCEL' | translate }}</md-button>
            </div>
        </form>
    </md-card-content>
</md-card>
